<!DOCTYPE html>
<html>
  <head>
  <!-- Nav bar -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Meet The Danes</title>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
      <script type="text/javascript" src="http://js.pusherapp.com/1.9/pusher.min.js"></script>
    <%= stylesheet_link_tag  'application', media: 'all', 'data-turbolinks-track' => true %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css" rel="stylesheet">

    <%= csrf_meta_tags %>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61451496-1', 'auto');
      ga('send', 'pageview');

      $(function(){
        window.setTimeout(function() { $(".error_alert").alert('close'); }, 5000);
        window.setTimeout(function() { $(".error_notice").alert('close'); }, 5000);
      });

    </script>
    <% if current_host %>
      <script>
      // creates pusher variable, listens for a message in the hosts specific channel, then creates a new <li> in the notification dropdown list
        var pusher = new Pusher("<%= ENV['PUSHER_KEY'] %>");
        var userChannel = pusher.subscribe("private-host-<%= current_host.id %>");
          userChannel.bind('booking', function(data) {
          var location = "<li><a href=/bookings/" + data.booking_id+ " id = 'temp'> <span class='tab'>You have a New Booking</span></a></li>";
          $("#notification_list").prepend(location); 
          $("#temp").css("background-color", "#bdc3c7")
          $("#notification-dropdown").css("background-color", "#3498db"); 

        });
      </script>
    <% end %>
  </head>

  <header class = "navbar navbar-fixed-top navbar-inverse" style="border-color:#222; height:50px">
    <%= render 'layouts/header_default' %>
  </header>

    <body class="<%= controller_name %> <%= action_name %>" style="padding: 50px 0 0 0">

  <% if notice %>
    <div class="alert alert-success-alt alert-dismissable error_notice">
      <span class="glyphicon glyphicon-certificate"></span>
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
      <%= notice %>
      <% flash[:notice].clear %>
    </div>
  <% end %>
  <% if alert %>
    <% alert = Array.new(1, flash[:alert]) if (flash[:alert].kind_of?(String) && !flash[:alert].empty?) %>
    <% alert ||= flash[:alert] %>
    <% alert.each do |msg| %>
      <div class="alert alert-danger-alt alert-dismissable error_alert">
        <span class="glyphicon glyphicon-certificate"></span>
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
        <%= msg %>
      </div>
    <% end if alert.kind_of?(Array)%>
    <% flash[:alert].clear %>
  <% end %>

      <!-- </div> -->


    <!-- this is doubled up in some pages, should refactor -->

    <%= yield %>
    <!-- </div> -->


    <div style='float:bottom'>
  	  <%= render 'layouts/footer' %>
      <%= debug(params) if Rails.env.development? %>
    </div>
  <!--       <%= debug(params) if Rails.env.development? %>
 -->

  </body>
</html>
